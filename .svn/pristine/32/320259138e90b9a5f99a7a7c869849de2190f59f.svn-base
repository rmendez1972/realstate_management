<?php
class AsesoresController extends BaseController{
    public function mostrarAsesores(){
        $asesores=Asesor::orderBy('nombre_razon')->orderBy('apellido_paterno')->orderBy('apellido_materno')->paginate(20);
        return View::make('asesores.lista')->withAsesores($asesores);
    }

    public function nuevo(){
        $tpersonas=TipoPersona::all();
        $municipios=Municipio::all();
        return View::make('asesores.nuevo', array('tipos_personas' => $tpersonas, 'municipios' => $municipios));
    }

    public function guardarNuevo(){
        $asesor=new Asesor();
        $asesor->nombre_razon=Input::get('nombre_razon');
        $asesor->apellido_paterno=Input::get('apellido_paterno');
        $asesor->apellido_materno=Input::get('apellido_materno');
        $asesor->rfc=Input::get('rfc');
        $asesor->id_tipo_persona=Input::get('id_tipo_persona');
        $asesor->cve_municipio=Input::get('cve_municipio');
        $asesor->colonia_region=Input::get('colonia_region');
        $asesor->calle=Input::get('calle');
        $asesor->manzana=Input::get('manzana');
        $asesor->numero_interior=Input::get('numero_interior');
        $asesor->numero_exterior_lote=Input::get('numero_exterior_lote');
        $asesor->codigo_postal=Input::get('codigo_postal');
        $asesor->telefono=Input::get('telefono');
        $asesor->celular=Input::get('celular');
        $asesor->email=Input::get('email');
        $asesor->doctos_faltantes=Input::get('doctos_faltantes');
        $asesor->id_usuario=Auth::user()->get()->id;
        $asesor->save();
        return Redirect::to('asesores');
    }

    public function editar($id){
        $asesor=Asesor::find($id);
        $tpersonas=TipoPersona::all();
        $municipios=Municipio::all();
        return View::make('asesores.editar', array('asesor' => $asesor,'tipos_personas' => $tpersonas, 'municipios' => $municipios));
    }

    public function guardarEditar(){
        $asesor=Asesor::find(Input::get('id'));
        $asesor->nombre_razon=Input::get('nombre_razon');
        $asesor->apellido_paterno=Input::get('apellido_paterno');
        $asesor->apellido_materno=Input::get('apellido_materno');
        $asesor->rfc=Input::get('rfc');
        $asesor->id_tipo_persona=Input::get('id_tipo_persona');
        $asesor->cve_municipio=Input::get('cve_municipio');
        $asesor->colonia_region=Input::get('colonia_region');
        $asesor->calle=Input::get('calle');
        $asesor->manzana=Input::get('manzana');
        $asesor->numero_interior=Input::get('numero_interior');
        $asesor->numero_exterior_lote=Input::get('numero_exterior_lote');
        $asesor->codigo_postal=Input::get('codigo_postal');
        $asesor->telefono=Input::get('telefono');
        $asesor->celular=Input::get('celular');
        $asesor->email=Input::get('email');
        $asesor->doctos_faltantes=Input::get('doctos_faltantes');
        $asesor->id_usuario=Auth::user()->get()->id;
        $asesor->save();
        return Redirect::to('asesores');
    }
}